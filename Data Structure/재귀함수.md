# 재귀함수

## 재귀함수 (Recursion)
-  호출된 함수가 자기 자신을 다시 호출하는 것
-  커다란 문제를 쪼개 부분 문제로 만들어 해결함으로써 전체 문제를 풀어 나가는 구조를 설계할 때는 반드시 필요하다.

## 스택 프레임으로 재귀 함수 이해하기
- 처음 재귀 함수를 공부할 때 가장 힘든 점은 어떻게 실행되고 있는 함수가 스스로를 다시 호출할 수 있는가 하는 것이다.
  - 이런 의문점은 함수가 호출될 때 내부적으로 일어나는 일을 알고나면 자연스업게 해결할 수 있다.

- 함수가 호출되면 메모리에서는 스택 프레임이라는 공간이 생긴다.
- 스택 프레임에는 함수 실행에 필요한 지역 변수들이 할당된다.

```python
def add_two(a, b):
    c = a + b # 4
    return c

a = 10 # 1
b = 20 # 2
result = add_two(a, b) # 3
print(result)
```

- #1과 #2는 프로그램이 시작되면서부터 끝날 때까지 메모리에 유지되는 전역 변수이다.
- #3에서 a와 b를 인수로 전달하고 add_two 함수를 호출하면 내부적으로 '스택 프레임'이라는 내부 공간이 생긴다.
  - 그 공간에 add_two 함수 내부에 있는 매개변수 a, b와 그 결괏값을 담을 지역 변수 c가 저장된다.
  - 그래서 코드를 실행하면 30이 출력된다. 

- #3에서 매개변수로 전달된 a와 b는 #1 과 #2에 있는 a, b가 아님을 알 수 있다.
- #3에서 함수가 호출된 순간 매개변수를 비롯한 지역 변수를 저장할 공간을 따로 만들고, 전달된 10과 20이라는 a와 b값만 복사하여 전달하게 된다.
- 최종적으로 a와 b의 연산이 끝나고 c에 값이 잘 저장된 후에는 return을 만나면 함수가 종료되는데, 이때 만들어졌던 add_two 함수의 스택 프레임 역시 사라진다.
  - 스택 프레임의 생성 시기는 함수를 호출했을 때고, 소멸 시기는 함수 실행이 종료되었을 때이다. 

- 재귀 함수를 실행하면서 함수가 자기 스스로를 호출하면 스택 프레임이 쌓이게 된다.
- 그럼 왜 재귀 함수를 계속 실행하면 RecursionError가 발생하는가?
  -  스택 프레임은 메모리에 생성되는데 생성될 수 있는 크기에 한계가 있다.
  -  그러므로 계속 쌓인다면 언젠가는 최대 한계치에 도달할 수 밖에 없다.
    - 이때 발생하는 에러가 Recursion Depth 에러이다.
- 에러를 방지하려면 함수 호출을 막아 줄 기저 사례가 필요하다.
  - 기저 사례는 전달받은 매개변수 값이 특정 값에 도달하면 함수가 호출되는 것을 막아준다.
  - 함수 구조를 살펴보면 보통 호출 코드가 있는 부분으로 가지 않고 계산된 값을 반환하며 함수를 종료한다.
    - 예를 들어 팩토리얼에서 이 특정 조건이 0! = 1이므로 이 조건을 기저 사례로 사용할 수 있다.

## 재귀 함수 정리
- 재귀 함수를 스택 프레임 관점에서 바라보면 상태 정보를 가지고 있는 지역 변수는 서로 다른 스택 프레임에 저장된다.
- 그러므로 함수 내에서 자기 자신을 호출한다고 해도 같은 기능의 코드를 실행하는 것일 뿐 그 실행 결과는 서로 다른 스택 프레임에 있는 지역 변수에 저장된다.
- 이때 기저 사례를 두지 않으면 계속 호출이 일어나고 스택 프레임이 저장되는 메모리가 한정적이므로 언젠가는 오류가 발생한다.

## 재귀 함수 설계
1. 언제 어떤 인수를 전달하여 호출할 것인지 (매개변수의 설계)
2. 재귀 호출을 멈추는 조건인 기저 사례 정하기

- 재귀 함수가 스스로를 호출할 때 매개변수를 그 크기가 줄어드는 형태로 전달하여 언젠가는 반드시 기저 사례와 만나게 해야만 에러를 일으키지 않는다.
- [재귀함수 순열](https://thebook.io/080200/ch01/01/03-03/)

